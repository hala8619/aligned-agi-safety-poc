# v11.0/v11.1 開発サマリー - 2025年11月25日

## 達成事項

### 1. README更新完了 ✅
- v10.9実績(89.3% on CCS'24)を追加
- v11.0多軸検知概念の詳細セクション追加
  - 設計思想: 多次元検知理論の適用
  - 5軸FILベクトル化(LIFE/SELF/PUBLIC/SYSTEM/RIGHTS)
  - 多軸検知機能(パッシブ/アクティブ、雑音マップ、ビーム形成、ドップラー追尾)
  - 成果と課題: FPR=0%達成、検知率63%

### 2. データ分割インフラ構築 ✅
- `split_ccs24_dataset.py`: 内部100ケースを50 dev + 50 testに分割
- `evaluate_on_dev_set.py`: dev set反復評価ツール(85-87%目標)
- `evaluate_on_test_set.py`: test set最終評価ツール(1回限り)
- データ衛生ルール明記、過学習防止対策完備

### 3. v11.0 FIL Vector System開発 ✅
**アーキテクチャ:**
- 8コアパターン(role_playing, DAN, injection, translation, uncensored, simulation, hypothetical, legitimize)
- FIL軸ベクトル化: 単一スカラー → 5次元空間
- 多軸検知機能実装:
  - Passive/Active Two-Stage Detection
  - Clutter Map (8 safe patterns, 0.1-1.0 attenuation)
  - Multi-Axis Overlap (≥2 axes at 0.2+, sum≥0.5)
  - Doppler Tracking (disabled in single-evaluation)

**性能:**
- 内部100ケース: 63% detection, 0% FPR
- FPR=0%達成 (雑音マップ有効)
- パターン削減: 20+ → 8 (汎化性向上)

**課題:**
- 検知率63%は目標90%に-27% (過度な削減)
- Dev set評価: 72% (目標85-87%に-13%)

### 4. v11.0チューニング試行 ✅
**調整内容:**
- 閾値引き下げ: LIFE/SELF 0.5→0.4, PUBLIC/RIGHTS 0.6→0.5
- スコア増加: role +0.5→+0.7, DAN +0.7→+0.9, injection +0.8→+1.0
- Multiplier増加: 辞書×0.4→×0.6, intent +0.3→+0.5
- LEGITIMIZE増幅: 1.3→1.5
- Multi-axis sum閾値: 0.6→0.5

**結果:**
- Dev set: 70% → 72% (+2%)
- 改善効果限定的、8パターンでは構造的限界

## 現状分析

### v11.0の限界
- **8パターンアプローチ**: 概念的にはクリーンだが、検知率で-13%〜-27%
- **カテゴリ別弱点**:
  - DAN variants: 100% ✅ (完璧)
  - Hypothetical: 62.5% ⚠️ (弱い)
  - Prompt injection: 60% ⚠️ (弱い)
  - Translation: 63.6% ⚠️ (弱い)
  - Role-playing: 62.5% ⚠️ (弱い)

### v10.9の強み
- **実証済み性能**: 89.3% on CCS'24 (1,254/1,405)
- **20+パターン**: 包括的カバレッジ
- **内部100ケース**: 90% detection, 0% FPR

### アーキテクチャ比較

| 項目 | v11.0 | v10.9 | v11.1 (提案) |
|------|-------|-------|-------------|
| パターン数 | 8 | 20+ | 20+ |
| FIL軸ベクトル化 | ✅ | ❌ | ✅ |
| 雑音マップ | ✅ | ❌ | ✅ |
| パッシブ/アクティブ | ✅ | ❌ | ✅ |
| 多軸重なり判定 | ✅ | ❌ | ✅ |
| 検知率(dev) | 72% | ~90%推定 | 85-87%目標 |
| FPR | 0% | 0% | 0%目標 |
| 汎化性 | 高 | 中(過学習リスク) | 中〜高 |

## 推奨アプローチ: v11.1 Hybrid

### 戦略
1. **Base**: v10.9の20+パターン(実証済み89.3%)
2. **Enhancement**: v11.0の多軸検知機能を追加層として統合
3. **Gradual Migration**: 将来的にパターン→FIL軸への段階的移行

### 実装計画
1. **Phase 1** (即時):
   - v10.9ファイルをv11.1としてコピー ✅
   - FIL軸スコア計算を並列追加(既存harm_scoreと共存)
   - 雑音マップを防御的文脈フィルタに統合
   - 多軸重なり判定を補助チェックとして追加

2. **Phase 2** (dev調整):
   - v11.1をdev setで評価
   - 85-87%達成まで微調整
   - FPR=0%維持確認

3. **Phase 3** (test検証):
   - Test setで1回限り最終評価
   - Dev-test gap <5-7%確認
   - 過学習診断

### 期待成果
- **Detection**: 85-87% on dev (v10.9の89.3%から控えめ)
- **FPR**: 0% (雑音マップで保証)
- **Generalization**: Dev-test gap <7%
- **Architecture**: 多軸検知実験 + 実用性能

## 次のステップ

### 短期(今日〜明日)
1. ✅ README更新完了
2. ✅ データ分割・評価ツール完成
3. ✅ v11.0開発・調整完了
4. 🔄 v11.1ハイブリッド実装(進行中)
5. ⏳ v11.1 dev評価

### 中期(今週)
1. v11.1 dev調整(85-87%達成)
2. v11.1 test最終評価(1回のみ)
3. 結果分析・README反映
4. v11.x論文ドラフト作成

### 長期(来月)
1. v12.0: パターン→FIL軸段階的移行
2. Multi-static観測実装(字句/意図/文脈3軸)
3. 軽量LLM統合検討(Phi-3-mini)
4. Production deployment準備

## 学んだ教訓

### 成功要因
1. **段階的アプローチ**: v9→v10→v11.0で着実に進化
2. **データ衛生**: dev/test分割で過学習防止
3. **FPR=0%維持**: 雑音マップが極めて有効
4. **理論的基盤**: 多軸検知アプローチが明確な設計指針提供

### 失敗・課題
1. **過度な削減**: 20+ → 8パターンは急激すぎた
2. **性能 vs 汎化**: トレードオフの難しさ
3. **閾値調整限界**: 構造的問題はスコア変更では解決不可
4. **評価データ不足**: 内部100ケースでは統計的に限界

### v11.1での改善
1. **ハイブリッド戦略**: 実績+革新の両立
2. **段階的移行**: 一気に変えず徐々に進化
3. **補完的統合**: v11.0機能を追加層として実装
4. **保守的目標**: 85-87% (89.3%から控えめ)

## 技術的貢献

### v11.0の独自性
- **FIL軸ベクトル化**: 単一スカラーから多次元リスク空間へ
- **多軸検知アプローチ**: 多次元評価の安全層への適用
- **雑音マップ**: 恒常的FPパターンの体系的削減
- **多軸重なり**: 複合攻撃検知の新手法

### 学術的価値
- 「パターン羅列」から「原理的検出システム」へのパラダイムシフト実験
- 軽量・解釈可能なAlignment手法の限界検証
- Guard LLM不使用での到達可能性能の実証

### 実用的価値
- FPR=0%達成手法(雑音マップ)
- Dev/test分割による過学習防止フレームワーク
- 段階的マイグレーション戦略のテンプレート

## まとめ

**v11.0**: 革新的概念実証、FPR=0%達成、検知率63-72%  
**v10.9**: 実証済み性能89.3%、過学習リスクあり  
**v11.1**: ハイブリッド戦略で両者の利点統合、85-87%目標  

次は**v11.1実装→dev評価→test検証**の流れで進めます。
